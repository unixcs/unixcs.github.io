<!DOCTYPE html>
<html lang="zh-cmn-Hans">
<head><meta name="generator" content="Hexo 3.9.0">
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <title>Docker | Unixcs</title>
  
    <link rel="icon" href="/assets/2.ico">
  
  
  
  <!--link rel="stylesheet" href="//cdn.jsdelivr.net/highlight.js/9.10.0/styles/github-gist.min.css"-->
  <link rel="stylesheet" href="//cdn.jsdelivr.net/highlight.js/9.10.0/styles/github-gist.min.css">
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
<div class="Shell">
    <aside class='SideBar'>
    <section class='avatar' style="background-image: url(/assets/background.png)">
        <div class='av-pic' style="background-image: url(/assets/header.jpg)">
        </div>
    </section>
    <section class='menu'>
        <div>Unixcs</div>
        
            <div>Be the Master of Time!</div>
        
        <ul>
          
            <a href="/" class="Btn">
              <li>Home</li>
            </a>  
          
            <a href="/archives/" class="Btn">
              <li>Archive</li>
            </a>  
          
            <a href="/tags/" class="Btn">
              <li>Tags</li>
            </a>  
          
            <a href="/about" class="Btn">
              <li>About</li>
            </a>  
          
        </ul>
    </section>
    <section class="media">
        
            
                <a href="https://github.com/unixcs">
                    <img src="/assets/github.svg" />
                </a>
            
        
    </section>
</aside>

    <div class="container">
        <div data-pager-shell>
            <div>
  <article class='ContentView'>
    <header class='PageTitle'>
        <h1>Docker</h1>
    </header>

<!--    <aside id="article-toc" role="navigation" class="fixed">
    <div id="article-toc-inner">
        <strong class="sidebar-title">
        ç›®å½•</strong>
        <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">0x00</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">0x01</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#null"><span class="toc-text">é•œåƒï¼ˆimageï¼‰å’Œå®¹å™¨ï¼ˆcontainerï¼‰</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#null"><span class="toc-text">å®¹å™¨</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#null"><span class="toc-text">é•œåƒ</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">0x02</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">ä¸€. é•œåƒ</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#null"><span class="toc-text">é•œåƒå‘½ä»¤</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">äºŒ.å®¹å™¨</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">0x03</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#null"><span class="toc-text">1. Exited (1) é”™è¯¯</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#null"><span class="toc-text">2. é…ç½®æ²¡é—®é¢˜ï¼Œè®¿é—®æ­å»ºçš„nginxä¸æˆåŠŸ</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">è¿›å…¥docker æ–¹æ³•</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#null"><span class="toc-text">dockerå¸è½½</span></a></li></ol>
    </div>
</aside>  -->
<!--    ç›®å½•  -->


    <section>

     <h2><span id="0x00">0x00</span></h2><p><strong>å‰è¨€</strong><br>å¥½ä¹…æ²¡æ›´æ–°åšå®¢äº†ï¼Œæ„Ÿè§‰æ¯å¤©éƒ½åœ¨è™šåº¦å…‰é˜´ï¼Œè¦ç»™è‡ªå·±æŒ‡å®šä¸€ä¸ªå­¦ä¹ è®¡åˆ’ï¼Œè®©è‡ªå·±å¿™èµ·æ¥ï¼ï¼<br>è®°ä¸€ä¸‹æœ€è¿‘åˆšæ¥è§¦çš„dokerå§ï¼ŒæŠŠç¬”è®°çŸ¥è¯†ç‚¹æ±‡æ€»ä¸€ä¸‹ã€‚</p>
 <a id="more"></a> 




<h2><span id="0x01">0x01</span></h2><p><strong>Dcoker æ˜¯ä»€ä¹ˆï¼Ÿï¼Ÿ</strong></p>
<p><img src="https://unixcs.oss-cn-beijing.aliyuncs.com/img/docker.jpg" alt></p>
<p>Dockerçš„æ€æƒ³æ¥è‡ªäº<code>é›†è£…ç®±</code>ï¼Œé›†è£…ç®±è§£å†³äº†ä»€ä¹ˆé—®é¢˜ï¼Ÿ<br>åœ¨ä¸€è‰˜å¤§èˆ¹ä¸Šï¼Œå¯ä»¥æŠŠè´§ç‰©è§„æ•´çš„æ‘†æ”¾èµ·æ¥ã€‚<br>å¹¶ä¸”å„ç§å„æ ·çš„è´§ç‰©è¢«é›†è£…ç®±æ ‡å‡†åŒ–äº†ï¼Œé›†è£…ç®±å’Œé›†è£…ç®±ä¹‹é—´ä¸ä¼šäº’ç›¸å½±å“ã€‚<br>é‚£ä¹ˆæˆ‘å°±ä¸éœ€è¦ä¸“é—¨è¿é€æ°´æœçš„èˆ¹å’Œä¸“é—¨è¿é€åŒ–å­¦å“çš„èˆ¹äº†ã€‚<br>åªè¦è¿™äº›è´§ç‰©åœ¨é›†è£…ç®±é‡Œå°è£…çš„å¥½å¥½çš„ï¼Œé‚£æˆ‘å°±å¯ä»¥ç”¨ä¸€è‰˜å¤§èˆ¹æŠŠä»–ä»¬éƒ½è¿èµ°ã€‚</p>
<br>
<br>

<blockquote>
<p>è¿˜ä¸æ‡‚ä»€ä¹ˆæ˜¯dockerï¼Ÿé‚£å°±çœ‹çœ‹è¿™ä¸¤ä¸ªç”ŸåŠ¨å½¢è±¡é€šä¿—æ˜“æ‡‚çš„ä¾‹å­å§<br><a href="https://my.oschina.net/jamesview/blog/2994112" target="_blank" rel="noopener">Case1</a><br><a href="https://www.jianshu.com/p/8cccc39c9f1c" target="_blank" rel="noopener">Case2</a> </p>
</blockquote>
<br>
<br>
<br>

<h4><span id="é•œåƒimageå’Œå®¹å™¨container">é•œåƒï¼ˆimageï¼‰å’Œå®¹å™¨ï¼ˆcontainerï¼‰</span></h4><p>è®²docker ä¹‹å‰å¿…é¡»è¦æçš„ä¸¤ä¸ªè¯ <strong>é•œåƒ</strong> and <strong>å®¹å™¨</strong></p>
<p>é‚£ä¹ˆä»€ä¹ˆæ˜¯é•œåƒï¼Ÿä»€ä¹ˆåˆæ˜¯å®¹å™¨å‘¢ï¼Ÿ </p>
<h4><span id="å®¹å™¨">å®¹å™¨</span></h4><p>é€šä¿—æ¥è®²å®¹å™¨å°±æ˜¯è£…ä¸œè¥¿çš„ç®±å­ï¼Œä½ å¯ä»¥æŠŠå®ƒç†è§£ä¸º <strong>é›†è£…ç®±</strong><br>å®¹å™¨å¥½æ¯”è½¯ä»¶é›†è£…ç®±ï¼Œå®ƒå†…éƒ¨å¯ä»¥å®‰è£…ä»»ä½•è½¯ä»¶å’Œåº“æ–‡ä»¶ï¼Œåšä»»æ„çš„è¿è¡Œç¯å¢ƒé…ç½®ã€‚</p>
<ul>
<li>é•œåƒæ˜¯é™æ€çš„ã€‚</li>
<li>ä¸€ä¸ªé•œåƒå¯ä»¥åˆ›å»ºå¤šä¸ªå®¹å™¨ã€‚</li>
</ul>
<h4><span id="é•œåƒ">é•œåƒ</span></h4><p>ä½ å¯ä»¥æŠŠé•œåƒçœ‹æˆæ˜¯æˆ‘ä»¬ç”µè„‘çš„é‡Œé¢çš„ <strong>è½¯ä»¶å®‰è£…åŒ…</strong><br>Dockerè¿è¡Œå®¹å™¨å‰éœ€è¦æœ¬åœ°å­˜åœ¨å¯¹åº”çš„é•œåƒï¼Œä¸€ä¸ªé•œåƒå¯ä»¥åˆ›å»ºå¤šä¸ªå®¹å™¨ï¼Œ</p>
<ul>
<li>å®¹å™¨æ˜¯åŠ¨æ€çš„ã€‚</li>
<li>é•œåƒå¯¹äºå®¹å™¨åªæ˜¯å¯è¯»çš„ã€‚</li>
</ul>
<br>
<br>



<h2><span id="0x02">0x02</span></h2><p><strong>æ­å»ºdockerä¸»è¦æµç¨‹ï¼š</strong></p>
<p><strong>æ‰¾é•œåƒ(search) -&gt; ä¸‹é•œåƒ(pull) -&gt; æŸ¥çœ‹é•œåƒ(images) -&gt; é•œåƒä¸­åˆ›å»ºå®¹å™¨(run) -&gt; æŸ¥çœ‹å®¹å™¨(ps)</strong></p>
<hr>
<p>æˆ‘ç”¨çš„æ˜¯centos7æ­å»ºçš„docker<br>æ£€æŸ¥centosç‰ˆæœ¬æ˜¯å¦æ”¯æŒdocker</p>
<p>1.æŸ¥çœ‹å†…æ ¸ç‰ˆæœ¬ (æ˜¯å¦å¤§äº3.10)<br><code>uname -r</code> </p>
<p>2.å®‰è£…docker<br><code>yum -y install docker</code><br>å®‰è£…æœ€æ–°ç‰ˆæœ¬<br><code>yum -y install docker-ce</code><br><em>å®‰è£…å‡ºç°é—®é¢˜</em>â€“&gt;<a href="https://blog.csdn.net/xixiworld/article/details/71438794" target="_blank" rel="noopener">æ–‡ç« </a></p>
<p>yum install  docker-ce-<version_string> (æŒ‡å®šå®‰è£…ç‰ˆæœ¬) </version_string></p>
<p><code>systemctl start docker</code>     å¼€å¯docker<br><code>systemctl enable docker</code>    å¼€æœºå¯åŠ¨<br><code>docker version</code>             æŸ¥çœ‹dockerç‰ˆæœ¬å·</p>
<p>3.éªŒè¯æ˜¯å¦å®‰è£…æˆåŠŸ</p>
<p><code>docker run hello-world</code></p>
<blockquote>
<p>åˆ°è¿™é‡Œå…¶å®dockerå·²ç»å®‰è£…å¥½äº†ï¼Œä½†ï¼å®‰è£…å¥½ä»…ä»…åªæ˜¯ç¬¬ä¸€æ­¥éª¤ï¼›<br>åé¢è¿˜è¦ä¸‹è½½æ‰€éœ€çš„é•œåƒæˆ–è€…ä½¿ç”¨dockerfileè‡ªè¡Œæ„å»ºdockeré•œåƒï¼›<br>æœ€åå†éƒ¨ç½²å®‰è£…ä½ çš„åº”ç”¨ç¨‹åºåˆ°dockerå®¹å™¨ä¸­ã€‚</p>
</blockquote>
<br>

<h2><span id="ä¸€-é•œåƒ">ä¸€. é•œåƒ</span></h2><p>ä¸‹è½½CentOS7 é•œåƒ<br><code>docker pull centos</code></p>
<p><strong>å®‰è£…æ—¶é‡åˆ°çš„é—®é¢˜</strong><br>x509: certificate has expired or is not yet validé”™è¯¯è§£å†³</p>
<p>è¿™ä¸ªé—®é¢˜åŸºæœ¬ä¸Šæ˜¯å› ä¸ºè¯ä¹¦å‡ºç°è¿‡æœŸå¯¼è‡´ã€‚</p>
<p><strong>è§£å†³åŠæ³•</strong><br>æŸ¥çœ‹è™šæ‹Ÿæœºå’Œè¿œç¨‹æœåŠ¡å™¨çš„æ—¶é—´æ˜¯å¦åŒæ­¥ï¼š<br>ğŸ‘‡ğŸ‘‡<br><code>date</code><br>è‹¥æ—¶é—´ä¸åŒæ­¥ï¼Œæ‰§è¡Œ<br><code>ntpdate cn.pool.ntp.org</code><br>è‹¥å®‰è£…å¤±è´¥ æ£€æŸ¥æ˜¯å¦å®‰è£…äº†ntpate<br><code>yum install ntpdate -y</code> </p>
<h4><span id="é•œåƒå‘½ä»¤">é•œåƒå‘½ä»¤</span></h4><p>1.æœç´¢é•œåƒ<br>docker search å…³é”®è¯</p>
<p>2.è·å–é•œåƒ<br>docker pull ä»“åº“åç§°[:tag]</p>
<p>3.æŸ¥çœ‹é•œåƒ<br><code>docker images</code>         </p>
<p>4.åˆ é™¤é•œåƒ<br><code>docker rmi [image id]</code><br><code>docker rmi [tag]</code>  //ä»“åº“å</p>
<blockquote>
<p>ä½¿ç”¨ <strong>docker rmi [id]</strong> å‘½ä»¤æ—¶ï¼Œå¿…é¡»ç¡®ä¿è¯¥é•œåƒæ²¡æœ‰è¢«å®¹å™¨ä½¿ç”¨æ‰èƒ½è¿›è¡Œ;<br>åˆ é™¤æ—¶ç³»ç»Ÿä¼šå…ˆåˆ é™¤æ‰æŒ‡å‘è¯¥é•œåƒçš„æ‰€æœ‰æ ‡ç­¾ï¼Œç„¶ååˆ é™¤é•œåƒæœ¬èº«ã€‚</p>
</blockquote>
<p>5.å­˜å‡ºé•œåƒå’Œè½½å…¥é•œåƒ</p>
<p>docker save -o å­˜å‚¨æ–‡ä»¶å å­˜å‚¨çš„é•œåƒ</p>
<br>

<h2><span id="äºŒå®¹å™¨">äºŒ.å®¹å™¨</span></h2><p>1.åˆ›å»ºå®¹å™¨<br><code>docker create</code><br><code>docker run</code>        //åˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨  </p>
<p>2.æŸ¥çœ‹å®¹å™¨<br><code>docker ps</code><br><code>docker ps -a</code>             //    æŸ¥çœ‹æ‰€æœ‰docker</p>
<p>3.å¯åŠ¨/ç»ˆæ­¢å®¹å™¨<br><code>docker start [names]</code><br><code>docker stop [names]</code></p>
<p>4.åˆ é™¤å®¹å™¨     </p>
<ul>
<li><p>ç»ˆæ­¢çŠ¶æ€çš„å®¹å™¨<br><code>docker rm [CONTAINER ID]</code></p>
</li>
<li><p>æ­£åœ¨è¿è¡Œçš„å®¹å™¨<br><code>docker rm -f [CONTAINER ID]</code></p>
</li>
</ul>
<p>5.è¿›å…¥å®¹å™¨<br><code>docker exec -it [name] bash</code>          è¿›å…¥å®¹å™¨<br><code>docker run -i -t centos /bin/bash</code>     åˆ›å»ºcentos</p>
<blockquote>
<p>execæ˜¯è¿›å…¥å·²ç»å­˜åœ¨çš„å®¹å™¨ï¼Œrunæ˜¯åˆ›å»ºæ–°å®¹å™¨ </p>
</blockquote>
<p>5.é€€å‡ºå®¹å™¨<br><code>ctrl+d</code> é€€å‡ºå®¹å™¨ä¸”å…³é—­</p>
<p><code>ctrl+p+q</code> é€€å‡ºå®¹å™¨ä½†ä¸å…³é—­</p>
<p><code>docker kill -s HUP [å®¹å™¨å]</code></p>
<blockquote>
<p>HUP(1)æ˜¯è®©è¿›ç¨‹æŒ‚èµ·ï¼Œç¡çœ ;<br>kill (9)å…­äº²ä¸è®¤çš„æ€æ‰<br>term(15)æ­£å¸¸çš„é€€å‡ºè¿›ç¨‹</p>
</blockquote>
<br>
<br>

<hr>
<h2><span id="0x03">0x03</span></h2><p>docker logs errors and others</p>
<p>é‡åˆ°é—®é¢˜ã€è¿è¡Œä¸äº†ä¹‹ç±»çš„å…ˆçœ‹æ—¥å¿—æŠ¥é”™ä¿¡æ¯!
<br></p>
<h4><span id="1-exited-1-é”™è¯¯">1. Exited (1) é”™è¯¯</span></h4><p>è¿™ä¸ªæŠ¥é”™ä¿¡æ¯ æ˜¯æˆ‘åœ¨ä½¿ç”¨phpé•œåƒåˆ›å»ºä¸€ä¸ªæ–°çš„å®¹å™¨æ—¶å‡ºç°çš„ï¼Œå½“æ—¶åªçŸ¥é“å‚»ä¹ä¹çš„çš„å»ç™¾åº¦æœï¼Œä¸çŸ¥é“æŸ¥çœ‹docker logs æŠ¥é”™ï¼Œå¯¼è‡´èµ°äº†å¾ˆé•¿çš„å¼¯è·¯ï¼<br>é”™è¯¯åŸå› ï¼š phpçš„é…ç½®æ–‡ä»¶é‡Œ server è¢«æˆ‘æ‰“æˆäº†erver ï¼Œå‘ç°è¿™ä¸ªé”™è¯¯çš„æ—¶å€™ æˆ‘çœŸçš„æ˜¯æƒ³æŠŠè‡ªå·±æä¸€é¡¿(<del>å¤åˆ¶ç²˜è´´éƒ½èƒ½é”™</del>)</p>
<p>æ€»ç»“ï¼š    ç»†å¿ƒç»†å¿ƒå†ç»†å¿ƒï¼ï¼</p>
<p><strong>docker los å‘½ä»¤</strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">docker logs [OPTIONS] CONTAINER</span><br><span class="line">Options:</span><br><span class="line">        --details        æ˜¾ç¤ºæ›´å¤šçš„ä¿¡æ¯</span><br><span class="line">    -f, --follow         è·Ÿè¸ªå®æ—¶æ—¥å¿—</span><br><span class="line">        --since string   æ˜¾ç¤ºè‡ªæŸä¸ªtimestampä¹‹åçš„æ—¥å¿—ï¼Œæˆ–ç›¸å¯¹æ—¶é—´ï¼Œå¦‚42mï¼ˆå³42åˆ†é’Ÿï¼‰</span><br><span class="line">        --tail string    ä»æ—¥å¿—æœ«å°¾æ˜¾ç¤ºå¤šå°‘è¡Œæ—¥å¿—ï¼Œ é»˜è®¤æ˜¯all</span><br><span class="line">    -t, --timestamps     æ˜¾ç¤ºæ—¶é—´æˆ³</span><br><span class="line">        --until string   æ˜¾ç¤ºè‡ªæŸä¸ªtimestampä¹‹å‰çš„æ—¥å¿—ï¼Œæˆ–ç›¸å¯¹æ—¶é—´ï¼Œå¦‚42mï¼ˆå³42åˆ†é’Ÿï¼‰</span><br></pre></td></tr></table></figure>

<br>

<h4><span id="2-é…ç½®æ²¡é—®é¢˜è®¿é—®æ­å»ºçš„nginxä¸æˆåŠŸ">2. é…ç½®æ²¡é—®é¢˜ï¼Œè®¿é—®æ­å»ºçš„nginxä¸æˆåŠŸ</span></h4><p>é”™è¯¯åŸå› ï¼š</p>
<p>é‡å¯ä¸‹dockers<br>systemctl restart docker<br>é‡å¯å®¹å™¨<br>docker restart [name]</p>
<p>å†æ¬¡è®¿é—®<br>successï¼</p>
<br>
<br>
<br>
<br>

<hr>
<hr>
<br>

<h2><span id="è¿›å…¥docker-æ–¹æ³•">è¿›å…¥docker æ–¹æ³•</span></h2><ul>
<li><p><strong>exec</strong><br><code>docker exec [names] bash</code></p>
</li>
<li><p><strong>nsenter</strong></p>
</li>
</ul>
<p>1 . æŸ¥çœ‹å®¹å™¨[id]çš„è¿›ç¨‹çš„PID<br><code>docker inspect -f \{\{.State.Pid\}\} [CONTAINER ID]</code></p>
<p>2 . ä½¿ç”¨pidè¿›å…¥å®¹å™¨<br><code>nsenter --target $PID --mount --uts --ipc --net --pid</code><br>$PIDä¸ºç¬¬ä¸€æ­¥æŸ¥è¯¢åˆ°çš„PID</p>
<p><a href="https://blog.csdn.net/qq_39629343/article/details/80170164" target="_blank" rel="noopener">about nsenter install</a></p>
<br>


<h2><span id="dockerå¸è½½">dockerå¸è½½</span></h2><p>æŸ¥çœ‹å·²å®‰è£…çš„åŒ…<br><code>yum list installed | grep docker</code></p>
<p>åˆ é™¤åŒ…<br><code>yum -y remove docker-engine.x86_64</code></p>
<hr>
<p>æ¨èä¸¤ä¸ªdoker æ­å»º<a href="https://www.runoob.com/docker/docker-install-nginx.html" target="_blank" rel="noopener">nginx</a>ã€<a href="https://www.runoob.com/docker/docker-install-php.html" target="_blank" rel="noopener">php</a> ã€mysql çš„æ–‡ç« </p>
<p>å‚è€ƒï¼š<a href="https://blog.51cto.com/11134648/2160257" target="_blank" rel="noopener">https://blog.51cto.com/11134648/2160257</a></p>


      

    </section>
    
      <section class='ArticleMeta'>
          <div>
            å‘å¸ƒäº&nbsp;
            <time datetime="2019-06-11T06:21:44.000Z" itemprop="datePublished">
              2019-06-11
            </time>
          </div>
          
            <div>
              tags: 
  <li class="meta-text">
  { <a href="/tags/Linux/">Linux</a> }
  </li>


            </div>
          
      </section>
    
    
      <section>
        <div id="disqus_thread"></div>
        <script>
          window.disqus_config = function () {
            this.page.url = window.location.toString()
            this.page.identifier = window.location.pathname
          }
          if (typeof DISQUS === 'undefined') {
            (function() { // DON'T EDIT BELOW THIS LINE
              var d = document, s = d.createElement('script');
              s.src = 'https://.disqus.com/embed.js';
              s.setAttribute('data-timestamp', +new Date());
              (d.head || d.body).appendChild(s);
            })();
          } else {
            DISQUS.reset({
                reload: true,
                config: window.disqus_config
            })
          }
        </script>
      </section>
    
    
</article>

  
</div>

            <footer>
    <div>Â© 2019 - Unixcs </div>
    <div>
        <span>

        </span>
        <span>

        </span>
    </div>
</footer>

        </div>
    </div>
</div>
<script src="/js/pager/dist/singlepager.js"></script>
<script>
var sp = new Pager('data-pager-shell')

</script>
</body>
</html>